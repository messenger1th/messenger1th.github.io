

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/girl.png">
  <link rel="icon" href="/img/girl.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Epoch">
  <meta name="keywords" content="Epoch Blog">
  
    <meta name="description" content="Effective C++熟悉C++ Accustoming Yourself to C++条款1：View C++ as a federation of languages.  C Objected-Oriented C++ Template C++ STL  根据要使用的C++部分，来遵守相应的高效编程守则。 条款2：Prefer consts， enums, and inlines to #">
<meta property="og:type" content="article">
<meta property="og:title" content="Effective C++">
<meta property="og:url" content="https://messenger1th.github.io/2024/07/24/C++/Effective%20C++/index.html">
<meta property="og:site_name" content="Epoch">
<meta property="og:description" content="Effective C++熟悉C++ Accustoming Yourself to C++条款1：View C++ as a federation of languages.  C Objected-Oriented C++ Template C++ STL  根据要使用的C++部分，来遵守相应的高效编程守则。 条款2：Prefer consts， enums, and inlines to #">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-07-24T14:47:33.910Z">
<meta property="article:modified_time" content="2024-07-24T14:47:33.910Z">
<meta property="article:author" content="Epoch">
<meta property="article:tag" content="Epoch Blog">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>Effective C++ - Epoch</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"messenger1th.github.io","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"left","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Epoch</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" target="_blank" rel="noopener" href="https://github.com/messenger1th">
                <i class="iconfont icon-github-fill"></i>
                GitHub
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Effective C++"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-07-24 22:47" pubdate>
          2024年7月24日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          8.3k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          138 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="padding-left: 2rem; margin-right: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Effective C++</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Effective-C"><a href="#Effective-C" class="headerlink" title="Effective C++"></a>Effective C++</h1><h2 id="熟悉C-Accustoming-Yourself-to-C"><a href="#熟悉C-Accustoming-Yourself-to-C" class="headerlink" title="熟悉C++ Accustoming Yourself to C++"></a>熟悉C++ Accustoming Yourself to C++</h2><p><strong>条款1：View C++ as a federation of languages.</strong></p>
<ul>
<li>C</li>
<li>Objected-Oriented C++</li>
<li>Template C++</li>
<li>STL</li>
</ul>
<p>根据要使用的C++部分，来遵守相应的高效编程守则。</p>
<p><strong>条款2：Prefer consts， enums, and inlines to #defines.</strong></p>
<p><code>#define</code>是预处理命令，编译器看不它的存在。</p>
<ul>
<li>对于常量， 最好用<code>const</code>对象或者<code>enums</code>替换<code>#define</code></li>
<li>对于形似函数的宏，改用<code>inline</code>函数。</li>
</ul>
<p><strong>条款3：Use const whenever possible</strong></p>
<div class="code-wrapper"><pre><code class="hljs C++"><span class="hljs-type">char</span> greeting[] = <span class="hljs-string">&quot;Hello&quot;</span>;
<span class="hljs-type">char</span>* p1 = greeting;      <span class="hljs-comment">//non-const pointer, non-const data</span>
<span class="hljs-type">const</span> <span class="hljs-type">char</span>* p2 = greeting;<span class="hljs-comment">//non-const pointer, const data </span>
<span class="hljs-type">char</span>* <span class="hljs-type">const</span> p3 = greeting;<span class="hljs-comment">//const pointer, non-const data</span>
<span class="hljs-type">const</span> <span class="hljs-type">char</span>* <span class="hljs-type">const</span> p4 = greeting; <span class="hljs-comment">//const pointer, const data</span></code></pre></div>

<p>必要时，使用<code>mutable</code>修饰变量，使其不受<code>const</code>限制。</p>
<p><strong>条款4：Make sure that objects are initialized before they’re used.</strong></p>
<ul>
<li><p>区分<code>assignment</code>和<code>initialization</code>，并推荐使用列表初始化。</p>
</li>
<li><p>为了避免跨单元之初始化次序的问题，请使用<code>local static</code>对象替换<code>non-local</code></p>
</li>
</ul>
<h2 id="构造-x2F-析构-x2F-赋值运算-Constructor，Destructor，and-Assignment-Operators"><a href="#构造-x2F-析构-x2F-赋值运算-Constructor，Destructor，and-Assignment-Operators" class="headerlink" title="构造&#x2F;析构&#x2F;赋值运算 Constructor，Destructor，and Assignment Operators"></a>构造&#x2F;析构&#x2F;赋值运算 Constructor，Destructor，and Assignment Operators</h2><p><strong>条款5：Know what functions C++ silently writes and calls.</strong></p>
<p>编译器可以默认创建<code>default constructor</code>,<code>copy constructor</code>,<code>copy assignment</code>,<code>destrutor</code></p>
<p>除了<strong>含有const或者是声明为private的父类函数需要被调用时</strong>.</p>
<p><strong>条款6：Explicitly disallow the use of complier-generated functions you do not want.</strong></p>
<ul>
<li>为了防止编译器自动生成上述函数，可以将成员函数声明为private并不予实现。</li>
</ul>
<p><strong>条款7：Declare destructors virtual in polymorphic base classes.</strong></p>
<ul>
<li>让声明<code>virtual</code>析构函数被动态绑定，防止子类资源没有释放。</li>
</ul>
<p><strong>条款8：Prevent exceptions from leaving destructors.</strong></p>
<p>以防止</p>
<ul>
<li>未定义的行为</li>
<li>程序过早地结束</li>
</ul>
<p><strong>条款9： Never call virtual functions during construction or destruction.</strong></p>
<p>在构造期间， <code>virtual</code>函数不是<code>virtual</code>函数。</p>
<p>因为基类构造时，意味着子类还未初始化， 如果调用的是子类<code>virtual</code>版本，则会导致未定义的行为。</p>
<p>析构函数同理。</p>
<p>如果要实现<code>virtual</code>函数的功能，可在构造时，由子类向父类传递信息。</p>
<p>*<em>条款10：Have assignment operators return a reference to <em>this.</em></em></p>
<p>如 operator&#x3D;，+&#x3D;, &#x2F;&#x3D;, *&#x3D;&#x2F;, -&#x3D;。</p>
<div class="code-wrapper"><pre><code class="hljs cpp"><span class="hljs-type">int</span> x, y, z;
x = y = z = <span class="hljs-number">15</span>;</code></pre></div>

<p>为了实现连锁复制。</p>
<p><strong>条款11：Handle assignment to self in operator&#x3D;.</strong></p>
<p>考虑<strong>异常安全</strong>和<strong>自我赋值安全</strong>（释放资源前保证以后不再使用，如释放自己再使用自己的资源）；</p>
<p>使用copy and swap计数。</p>
<p><strong>条款12：Copy all parts of an object</strong></p>
<ul>
<li><p>Copying函数应该确保复制“对象内的所有成员变量”以及“所有base class”成分。</p>
</li>
<li><p>不要尝试以某个copying函数实现另一个copying函数。应该将共同部分放在第三个函数， 并由Copying函数调用。</p>
</li>
</ul>
<h2 id="资源管理-Resource-Management"><a href="#资源管理-Resource-Management" class="headerlink" title="资源管理 Resource Management"></a>资源管理 Resource Management</h2><p><strong>条款13：Use objects to manage resources.</strong></p>
<ul>
<li>为了防止资源泄露，请使用RAII对象。构造时获取资源，析构时自动释放资源。</li>
<li>两个常用的RAII是<code>tr1::shared_ptr</code>和<code>auto_ptr</code>。<code>auto_ptr</code>复制动作会使原对象指向<code>null</code>；注：**<code>unique_ptr</code>已经取代<code>auto_ptr</code>**</li>
</ul>
<p><strong>条款14：Think carefully about copying behavior in resource-managing classes.</strong></p>
<ul>
<li>复制RAII对象必须一并复制它所管理的资源，其copying行为由资源的copying行为决定。</li>
<li>常见RAII class copying 行为是：抑制copying、使用reference counting</li>
</ul>
<p><strong>条款15：Provide access to raw resource-managing classes.</strong></p>
<ul>
<li>APIs往往要求访问raw resource，所以RAII需要提供接口。</li>
<li>对<em>row resource</em>的访问可能仅由显示转换或隐式转换。</li>
</ul>
<p><strong>条款16：Use the same form in corresponding uses of new and delete.</strong></p>
<ul>
<li>如<code>new int[]</code> 对应<code>delete[] </code></li>
</ul>
<p><strong>条款17：Store newed objects in smart pointers in standalone statements.</strong></p>
<ul>
<li>为了防止资源<code>new</code>之后，还未放入<code>RAII</code>的时间内， 由于其他函数的异常导致的资源泄露</li>
<li>请将资源<code>new</code>和放入<code>RAII</code>的操作放在独立语句中。</li>
</ul>
<h2 id="设计与声明-Design-and-Declaration"><a href="#设计与声明-Design-and-Declaration" class="headerlink" title="设计与声明 Design and Declaration"></a>设计与声明 Design and Declaration</h2><p><strong>条款18：Make interfaces easy to use correctly and hard to use incorrectly</strong></p>
<ul>
<li>使用已经成熟类封装数据，如<code>Month</code>,<code>Day</code>,<code>Year</code>类来封装日期。</li>
<li>一旦类型的值是确定的，就可以限制其取值。如一年12个月，使用预定义的12个<code>static</code>函数返回对象。</li>
<li>限制类型内可做的事情。如<code>a * b = c</code>，让<code>a * b</code>返回一个<code>const</code>.</li>
<li>保持接口一致性，如命名规范，大小统一命名为<code>size</code>.</li>
<li>预判使用者的行为导致的一些错误。如使用者忘记释放资源。可以先发制人，直接返回一个<code>smart pointer</code></li>
<li><strong>综上，“促进正确使用”：接口一致性，与内置类型兼容。“阻止误用”：建立新类型限制类型上的操作，限制对象的取值，消除客户的资源管理责任</strong>。</li>
<li><code>tr1:shared_ptr</code>支持定制删除器<code>custom deleter</code>。可以防范DLL问题，可被用来自动解除互斥锁。</li>
</ul>
<p><strong>条款19：Treat class design as type design</strong></p>
<ul>
<li>如何被构造和析构，涉及到资源分配和资源释放的设计。</li>
<li>初始化和赋值行为有什么区别。</li>
<li>对象如果被<code>passed by value</code>意味着什么？ copy构造函数用于定义一个type的<em>pass by value</em>该如何实现？</li>
<li>考虑合法值的取值。并限制非法值。</li>
<li>是否需要配合继承体系？</li>
<li>需要什么样的类型转换？</li>
<li>什么样的操作符和函数对此<em>type</em>是合理的？</li>
<li>什么样的标准函数应该被驳回？那些必须声明为<em>private</em></li>
<li>哪个成员是<em>public</em>,<em>protected</em>,<em>private</em>,<em>friend</em>.</li>
<li><strong>什么是新<em>type</em>的未声明接口？</strong></li>
<li>是否要定义为<em>class</em> <em>template</em></li>
<li>真的需要一个新<em>type</em>吗， 还是只是新的<em>derived</em> <em>class</em>?</li>
</ul>
<p><strong>条款20： Prefer pass-by-reference-to-const to pass-by-value</strong></p>
<ul>
<li>无需拷贝，更为高效，且可以避免切割问题（子类传递后拷贝为父类）。</li>
<li>但内置类型以及STL的迭代器和函数对象，通常使用 <em>pass-by-value</em>更为高效。</li>
</ul>
<p><strong>条款21：Don’t try to return a reference when you must return an object</strong></p>
<ul>
<li>绝不要返回<em>pointer</em>或<em>reference</em>指向一个<em>local stack</em>对象。</li>
<li>考虑返回<em>reference</em>指向一个<em>heap-allocated</em>对象.</li>
<li>考虑拷贝返回。</li>
</ul>
<p><strong>条款22：Declare data members private</strong></p>
<ul>
<li>尽可能将成员变量声明为<em>private</em>.</li>
<li><em>protected</em>并不比<em>public</em>更有封装性。</li>
</ul>
<p><strong>条款23：Prefer non-member non-friend function to member functions</strong></p>
<p><strong>条款24：Declare not-member functions when type conversions should apply to all parameters.</strong></p>
<div class="code-wrapper"><pre><code class="hljs cpp"><span class="hljs-function">Rational <span class="hljs-title">oneHalf</span><span class="hljs-params">(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)</span></span>;
Rational result = <span class="hljs-number">2</span> * oneHalf;
Rational result = oneHalf * <span class="hljs-number">2</span>;</code></pre></div>

<p>重载<code>operator*</code>并让隐式转换成两个<code>Rational</code>对象相乘。对接上一个<em>non-member function</em>.</p>
<p><strong>条款25：Consider support for a non-throwing swap</strong></p>
<ul>
<li>当<code>std::swap</code>对你的类型效率不高时，提供一个<code>swap</code>成员函数，并确定它不抛出异常。</li>
<li>如果你提供一个<em>member swap</em>，也该提供一个<em>non-member swap</em>来调用前者</li>
<li>调用<em>swap</em>应该针对<code>std::swap</code>使用<code>using</code>声明式，然后调用<code>swap</code>并且不带任何“命名空间修饰”。</li>
<li>为“用户自定义类型”进行<em>std templates</em>全特化是好的，但不要在<em>std</em>内加入。</li>
</ul>
<h2 id="实现-Implement"><a href="#实现-Implement" class="headerlink" title="实现 Implement"></a>实现 Implement</h2><p><strong>条款26：Postpone variable definitions as long as possible</strong></p>
<ul>
<li>可以的话，直接初始化。而不是默认初始后再赋值。</li>
<li>考虑循环里头直接构造，还是在外头构造，循环内赋值的成本。</li>
</ul>
<p><strong>条款27：Minimize casting</strong></p>
<p><code>const_cast&lt;T&gt;(expression)</code> 移除<code>const</code>。</p>
<p><code>dynamic_cast&lt;T&gt;(expression)</code> </p>
<p><code>reinterpret_cast&lt;T&gt;(expression)</code></p>
<p><code>static_cast&lt;T&gt;(expression)</code> 强迫转型，如<code>int</code>转成<code>double</code>。<em>pointer-to-base</em>转成<em>pointer-to-derived</em>.</p>
<p><strong>条款28：Avoid returning “handles” to object internals.</strong></p>
<ul>
<li>可能会降低封装性。</li>
<li>可能会导致使用已经释放的资源。</li>
</ul>
<p><strong>条款29：Strive for exception-safe code</strong></p>
<ul>
<li>基本保证：不发生资源泄露和数据败坏。</li>
<li>强烈保证：要么执行成功，要么直接回滚到不执行的状态。</li>
<li>不抛出保证。</li>
</ul>
<p><strong>条款30：Understand the ins and outs of inlining</strong></p>
<ul>
<li><em>inline</em>函数在编译器直接将函数本体到替换到调用处。</li>
<li>因此，对于非inline函数来说，修改后重新编译链接这一个文件即可。而inline函数是需要重新编译所有调用文件的。</li>
<li>构造函数和析构函数含有不少代码，不建议<em>inline</em></li>
</ul>
<p><strong>条款31：Minimize compilation dependencies between files</strong></p>
<ul>
<li>支持”minimize compilation dependencies “的一般构想是：相依与声明式，不要相依与定义式。</li>
<li>程序库头文件应该以”完全且仅有声明式子“（full and declaration-only forms）的形式存在。这种做法不论是否涉及<em>templates</em>都适用。</li>
</ul>
<h2 id="继承与面向对象设计-Inheritance-and-Object-Oriented-Design"><a href="#继承与面向对象设计-Inheritance-and-Object-Oriented-Design" class="headerlink" title="继承与面向对象设计 Inheritance and Object-Oriented Design"></a>继承与面向对象设计 Inheritance and Object-Oriented Design</h2><p><strong>条款32：Make sure public inheritance models “is-a”</strong></p>
<ul>
<li>“public继承”意味着<em>is-a</em>;</li>
</ul>
<p><strong>条款33：Avoid hiding inherited names.</strong></p>
<ul>
<li><em>derived classes</em>内的名词会掩盖<em>base  classes</em>的名称，即<strong>名字查找先于类型检查。</strong></li>
<li>要用到被掩盖的名称，可以使用 <em>using</em>声明（全部显形）或者转交函数（<em>forwarding function</em>）（指定显形）。</li>
</ul>
<p><strong>条款34：Differentiate between inheritance of interface and inheritance of implementation</strong></p>
<ul>
<li><em>pure virtual</em>函数在基类可以有定义，但子类仍需要重写，必要时可以显示调用基类的定义。</li>
</ul>
<p><strong>条款35：Consider alternatives to virtual functions</strong></p>
<ul>
<li>NVI: non-virtual interface  基类中实现一个函数，调用相应<em>virtual</em>。</li>
<li><em>Strategy</em>  使用可调用的方式来替代<em>virtual</em>函数如 使用函数指针（但只能访问类中<em>public</em>的内容），或使用<code>tr1:function</code>调用（可调用物：可以是某个函数，函数对象，成员函数）。</li>
</ul>
<p><strong>条款36：Nevenr redefine an inherited non-virtual function</strong></p>
<ul>
<li>如果<em>override</em>一个 <em>non-virtual function</em>， 使用基类的指针或引用指向子类时候，调用的是基类（即声明类型）的版本（静态绑定）。</li>
<li>从 <em>is-a</em>的角度，基类的 <em>non-virtual function</em>应该具有不变性。不可被改变。</li>
</ul>
<p><strong>条款37：Never redefine a functions’ inherited default parameter value</strong></p>
<ul>
<li>默认参数在编译期已经确定，是静态的。</li>
<li>由于 <em>default parameter value</em>是静态的，取决于声明类型，而<em>virtual function</em>则是动态的，重定义默认参数会导致使用动态的<em>function</em>却使用了声明类型的默认参数。</li>
<li>解决办法是 条款35中的替代<em>virtual</em>的方案。</li>
</ul>
<p><strong>条款38： Model “has-a” or “is-implemented-in-terms-of” through composition</strong></p>
<ul>
<li><em>has-a</em> 如一个人有名字，身份证号码，这些是 <em>has-a</em>的关系。</li>
<li><em>is-implemented-in-terms-of</em> 如一个<em>set</em>可以由list来实现。</li>
</ul>
<p><strong>条款39：<em>Use private inheritance judiciously</em></strong></p>
<ul>
<li><em>private inheritance</em>意味着 <em>is-implemented-in-terms-of</em> 。它通常比 <em>composition</em>的级别低。但是当 <em>derived class</em>需要访问 <em>protected base class</em>的成员，或重新定义 <em>virtual</em>函数的时候，这样做是合理的。</li>
<li>较于 <em>composition</em>，<em>private</em>继承可以使得 <em>empty base</em>最优化，占用更少空间。</li>
</ul>
<p><strong>条款40：<em>Use multiple inheritance judiciously</em></strong></p>
<ul>
<li>多重继承比单一继承复杂。可能导致新的歧义性，以及对<em>virtual</em>继承的需要。</li>
<li><em>virtual</em>继承会增加大小、速度、初始化（及赋值）复杂度等等成本。如果<em>virtual base classes</em>不带任何数据，将是最具有使用价值的情况。</li>
<li>多重继承的确有正当用途。如“涉及<em>public</em>继承某个<em>interface  class</em>”和“<em>private</em>继承某个协助实现的<em>class</em>”</li>
</ul>
<h2 id="模板与泛型编程-Template-and-Generic-Programming"><a href="#模板与泛型编程-Template-and-Generic-Programming" class="headerlink" title="模板与泛型编程 Template and Generic Programming"></a>模板与泛型编程 <em>Template and Generic Programming</em></h2><p><strong>条款41：Understand implicit interfaces and compile-time polymorphism</strong></p>
<ul>
<li><em>classes</em> 和 <em>templates</em> 都支持接口（<em>interface</em>）和多态（<em>polymorphism</em>）。</li>
<li>对<em>classes</em>而言接口是显式的（<em>explicit</em>），以函数签名为中心。而多态则是通过 <em>virtual</em> 函数发生与运行期。</li>
<li>对<em>template</em>参数而言，接口是隐式的（<em>implicit</em>），基于有效表达式。多态则是通过<em>template</em>具现化和函数重载解析发生于编译期。</li>
</ul>
<p><strong>条款42：Understand the two meanings of <code>typename</code></strong></p>
<ul>
<li>声明<em>template</em>参数时，前缀关键字<code>class</code>和<code>typename</code>可互换。</li>
<li>请用<code>typename</code>标识嵌套从属类型（如<code>typename std::interator...</code>）。但不得在基类列表或者成员初值列内作为 <em>base class</em>修饰符。</li>
</ul>
<p><strong>条款43：Know how to access names in templatized base classes</strong></p>
<ul>
<li>由于 <em>template class</em>可能被特例化而缺少共同函数，因此 <em>derived template class</em>会默认不寻找基类的函数。</li>
<li>解决办法3种：<ul>
<li>使用<code>this-&gt;</code>修饰该函数。</li>
<li>使用<code>using</code>告诉编译器去基类寻找。</li>
<li>使用<code>::</code>明确寻找哪个函数。</li>
</ul>
</li>
</ul>
<p><strong>条款44： Factor parameter-independent code out of templates</strong></p>
<ul>
<li>这块我的代码量不够，没咋看懂。</li>
</ul>
<p><strong>条款45：Use member function templates to accept all compatible types</strong> </p>
<ul>
<li>请使用 <em>member function templates</em>生成“可接受所有兼容类型”的函数。</li>
<li>如果你声明 <em>member templates</em>用于“泛化<em>copy</em>构造”或“泛化<em>assignment</em>”。你还需要声明 <em>non-template</em>版本，否则编译器会帮你生成。</li>
</ul>
<p><strong>条款46：Define non-member functions inside templates when type conversions are desired</strong></p>
<ul>
<li><em>template</em>实参推导从不将隐式类型转换考虑在内。如条款24的例子在<em>template</em>的情况下行不通。</li>
<li><code>friend</code>的其他用法。</li>
</ul>
<p><strong>条款47：Use traits classes for information about types</strong></p>
<ul>
<li><em>Trait classes</em> 使得“类型相关信息”在编译器可用。它们以 <em>templates</em> 和 ”<em>template</em>特化“实现。</li>
<li><em>overloading</em>使得 ， <em>trains classes</em>可能在编译期对类型执行 <em>if…else</em>测试。</li>
</ul>
<p><strong>条款48： Be aware of template metaprogramming</strong></p>
<ul>
<li><em>Template metaprogramming</em>(TMP 模板元编程)可将工作由运行期移往编译期。得以实现早期错我侦测和更高的执行效率。</li>
<li>TMP可被用来生成”基于政策选择组合“（<em>based on combinations of policy choices</em>)的客户定制代码，也可用于避免生成对某些特殊类型并不适合的代码。</li>
</ul>
<h2 id="定制new和delete"><a href="#定制new和delete" class="headerlink" title="定制new和delete"></a>定制<code>new</code>和<code>delete</code></h2><p><strong>条款49：Understand the behavior of the new-handler</strong></p>
<p><strong>条款50：Understand when it makes sense to replace new and delete</strong></p>
<ul>
<li>有许多理由需要写一个自定的<code>new</code>和<code>delete</code>，包括改善效能、对<em>heap</em>运用错误进行调试、收集<em>heap</em>使用信息。</li>
</ul>
<p><strong>条款51：Adhere to conversion when writing new and delete</strong></p>
<ul>
<li><em>operator new</em>应该内含一个无穷循环，并在其中尝试分配内存。如果无法满足内存需求，就该调用 <em>new-handler</em>。它也应该有能力处理<em>0 bytes</em>申请。<em>Classes</em>专属版本则还应该处理”比正确大小更大的（错误）申请“。</li>
<li><em>operator delete</em>应该在收到<em>null</em>指针时不做任何事。<em>Classes</em>专属版本则还应该处理”比正确大小更大的（错误）申请“。</li>
</ul>
<p><strong>条款52：Write placement delete if you write placement new</strong></p>
<ul>
<li>写了<em>placement operator new</em>，要写对应版本的<em>delete</em>。</li>
<li>当你写了<em>placement new</em> 和 <em>placement delete</em>，请确定不要无意识地遮掩他们正常的版本。</li>
</ul>
<h2 id="杂谈：Miscellany"><a href="#杂谈：Miscellany" class="headerlink" title="杂谈：Miscellany"></a>杂谈：Miscellany</h2><p><strong>条款53：Pay attention to compiler warnings.</strong></p>
<p><strong>条款54：Familiar yourself with the standard library，including TR1</strong></p>
<p><strong>条款55：Familiarize yourself with Boost</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="http://boost.org/">Boost</a></li>
</ul>
<h2 id="读者总结"><a href="#读者总结" class="headerlink" title="读者总结"></a>读者总结</h2><p>前面几部分是容易接受的，直到模板这里头涉及文件的依赖性、元编程。以及<code>new</code>和<code>delete</code>部分。</p>
<p>模板这块代码量不够，不能彻底理解。<code>new</code>和<code>delete</code>也是。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/C/" class="category-chain-item">C++</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Effective C++</div>
      <div>https://messenger1th.github.io/2024/07/24/C++/Effective C++/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Epoch</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年7月24日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/07/24/C++/C++%20Primer/" title="C++ Primer">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">C++ Primer</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/07/24/C++/Effective%20Modern%20C++/" title="Effective Modern C++">
                        <span class="hidden-mobile">Effective Modern C++</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar category-bar" style="margin-left: -1rem">
    





<div class="category-list">
  
  
    
    
    
    <div class="category row nomargin-x">
      <a class="category-item 
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="C++"
        id="heading-f6f87c9fdcf8b3c3f07f93f1ee8712c9" role="tab" data-toggle="collapse" href="#collapse-f6f87c9fdcf8b3c3f07f93f1ee8712c9"
        aria-expanded="true"
      >
        C++
        <span class="list-group-count">(6)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse show" id="collapse-f6f87c9fdcf8b3c3f07f93f1ee8712c9"
           role="tabpanel" aria-labelledby="heading-f6f87c9fdcf8b3c3f07f93f1ee8712c9">
        
        
          
  <div class="category-post-list">
    
    
      
      
        <a href="/2024/07/24/C++/C++%20Primer/" title="C++ Primer"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">C++ Primer</span>
        </a>
      
    
      
      
        <a href="/2024/07/24/C++/Effective%20C++/" title="Effective C++"
           class="list-group-item list-group-item-action
           active">
          <span class="category-post">Effective C++</span>
        </a>
      
    
      
      
        <a href="/2024/07/24/C++/Effective%20Modern%20C++/" title="Effective Modern C++"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Effective Modern C++</span>
        </a>
      
    
      
      
        <a href="/2024/07/24/C++/Effective%20STL/" title="Effective STL"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Effective STL</span>
        </a>
      
    
      
      
        <a href="/2024/07/24/C++/More%20Effective%20C++/" title="More Effective C++"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">More Effective C++</span>
        </a>
      
    
      
      
        <a href="/2024/07/24/C++/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3C++11/" title="深入理解C++11"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">深入理解C++11</span>
        </a>
      
    
  </div>

        
      </div>
    </div>
  
</div>


  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
    <!-- 备案信息 ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      赣ICP备2024036505号
    </a>
  </span>
  
</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
